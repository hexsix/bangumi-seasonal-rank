---
import BaseLayout from "../layouts/BaseLayout.astro";
import AnimeRank from "../components/sections/AnimeRank.astro";

export async function getStaticPaths() {
    const data = await fetch(
        "https://api.rinshankaiho.fun/api/v0/season/available",
    ).then((res) => res.json());
    const available_seasons = data.available_seasons;
    return available_seasons.map((season_id: string) => ({
        params: { season_id: season_id },
    }));
}
const { season_id } = Astro.params;

function getSeasonName(seasonId: number) {
    const season_id = String(seasonId);
    const year = season_id.slice(2, 4);
    const season = season_id.slice(4, 6);
    return `${year}年${season}月`;
}
---

<BaseLayout currentSeasonId={season_id} pageTitle={getSeasonName(season_id)}>
    <AnimeRank season_id={season_id} />
</BaseLayout>
